
<!DOCTYPE html>
<html>
<head>
<meta name="mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=device-width, initial-scale=0.65, user-scalable=no" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">

  <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.js"></script>

  <link rel="stylesheet" type="text/css" href="http://fiddle.jshell.net/css/result-light.css">
  
  <script type="text/javascript" src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <script type="text/javascript" src="http://yoannmoinet.github.io/nipplejs/javascripts/nipplejs.js"></script>
    
  

  <style type="text/css">
  html {
    height:100%;
  }
    body {
  margin: 0 0 0 0;
  padding:0 0 0 0;
  background-color:#000;
  height:100%;
}
.flex-none {
  flex-grow:0 !important;
  width:1px;
}

.flex3 {
  width:1px;
  flex-grow:3 !important;  
}

.btn {
  background-color:#241450;
  height:1px;
  width:1px;
  min-width:50px !important;
  min-height:50px !important;
  align-self:center;
  border-radius:0.5em;
  border:solid blue 1px;
}


.btn img {
   max-height:50px; 
   position:relative;
   left:27%;
}

.btn-small img {
  left: 0%;
}

.input {
  background-color:#004488;
  max-height:50px;
  min-height:50px !important;
  height:1px;
  align-self:center;
  border-radius:0.5em;
}
.cell {
  flex-grow:1;
  min-height:100px;
  min-width:100px;
  height:1px;
  width:1px;
}

.space {
  flex-grow:1;
}

.row {
  display:flex; 
  flex-grow:1;
  padding-top:5px;
  padding-bottom:5px;
  min-width:100%;
  align-items:center;
}
.joystick {
  display: block;
  position: relative;
  left: 0px;
  top: 0px;
  display:flex;
  align-items:center;
  width:180px;
  height:180px;
}

.joystick img {
  height:50px;
  position:relative;
      left: calc(50% - 15px);
      top:12px;

}
  

.joy-ph {
  border-radius: 50%;
  background:repeating-radial-gradient( circle at 0 0, #040815, #152031 5px );
  width:200px;
  height:200px;
  flex-grow:0;
  color:red;
  border-right-color:red;
  border-bottom-color:green;
  border-top-color:blue;
  border-left-color:yellow;
  border-style:dotted;
}

.flex-more {
  flex-grow:2;
}
.column {
  display:flex;
  flex-direction:column;
}

.depressed {
  background-color:#ade9cc !important;
}

#outer {
  height:100%;
}

#home {
	position:relative;
	top:80px;
}

#back {
	position:relative;
	top:80px;
}

/*
#ll {
  position:relative;
  top:-12px;
}

#lr {
  position:relative;
  top:-40px;
  left: 60px;
}

#ll {
  position:relative;
  top:-40px;
  left:-12px;
}

#tl {
  position:relative;
  left:10px;
}

#tr {
  position:relative;
  left:20px;
}
*/

#kbm {
  position: relative;
  width:100px;
  height:100px;
  top:200px;
  left:-100px;
}

#kbm .joystick {
  width:90px;
  height:90px;
}

#kbw {
  position: relative;
  width:100px;
  height:100px;
  top:-10px;
  left:-10px;
}

#kbw .joystick {
  width:90px;
  height:90px;
}

#keyboard {
  z-Index:999;
  position:absolute;
  top: 60px;
  left:0px;
  background-color:#7A6C6C;
  width:100%;
  height:calc(100% - 50px);
}

.hide {
  display:none;
}

.key {
  background-color: #695959;
  color:white;

  font-size:larger;

  height:1px;
  width:1px;
  min-width:67px !important;
  min-height:67px !important;
  align-self:center;
  border-radius:0.5em;
  border:solid #cecece 1px;  
  text-align:center;
}

.flex-end .key {
  align-self: flex-end;
}

.dpad {
  background-color:#ff0000;
}

.mod {
  background-color:#000;
}

.adb {
  background-color:#0009cc;
}

.ui {
  background-color:#585808;
}

#coords {
  color:red;
}

#key {
	background-color:#fff;
	width:50px;
	height:50px;
	font-size:xx-large;
	position:fixed;
	top:10px;
	left:calc(50% - 25px);
	z-index:1001;
	text-align:center;
	valign:bottom;
	border-radius:0.25em;
}

#shell {
	position:absolute;
	top: 50px;
	left:0px;
    height:calc(100% - 50px);
    width:100%;
}

#output {
  height:calc(100% - 50px);
  width:100%;	
  background-color:#000;
  color:white;
}

#input {
	width:100%;
	height:50px;
}

#center {
  position: absolute;
  top: calc(50% + 30px);
  left: calc(50% - 0px);
  height:50px;
  width:50px;
  background-color:#f00;
  text-align:center;
  border-radius:48%;
  
}
  </style>

  <title></title>

  
    




<script type='text/javascript'>//<![CDATA[
$(window).load(function(){

document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
}, false); 
  
var joysticks = [];

$('#keyboard').addClass('hide');
$('#key').addClass('hide');
$('.input').on('click', function() {
  $('#keyboard').removeClass('hide');
});

$('#kbr').on('click', function() {
  $('#keyboard').addClass('hide');
});


$("#sync").on('click', function() {
  window.location.href = window.location.href;
});

$("#home").on('click', function() {
  send({
    type: 'key',
    data: {
      key: 'KEY_HOME',
      state: 1,
      sync: 1
    }
  });
  
  send({
    type: 'key',
    data: {
      key: 'KEY_HOME',
      state: 0,
      sync: 1
    }
  });  
});

$("#back").on('click', function() {
  send({
    type: 'key',
    data: {
      key: 'KEY_BACK',
      state: 1,
      sync: 1
    }
  });
  
  send({
    type: 'key',
    data: {
      key: 'KEY_BACK',
      state: 0,
      sync: 1
    }
  });  
});

$(".btn").on("touchstart", function(evt) {
  $(evt.target).addClass('depressed');
  navigator.vibrate(50);
});

$(".key").on("touchstart", function(evt) {
  $(evt.target).addClass('depressed');
  navigator.vibrate(50);
});


document.getElementsByTagName('DIV')[0].webkitRequestFullscreen();


$(".app").on("click", function(evt) {
  send({
    type: 'app',
    data: {
      id: $(this).attr('id')
    }
  });
  console.log(this);
});

$('.dpad').on('touchstart', function(evt) {
  i = ['kbu','kbl','kbd','kbr'].indexOf($(this).attr('id'));
  name = ['up','left','down','right'][i]; 
  
  send({
    type: 'keyboard',
    data: {
      key: name,
      action: 'down'
    }
  });
});

$('.dpad').on('touchend', function(evt) {
  i = ['kbu','kbl','kbd','kbr'].indexOf($(this).attr('id'));
  name = ['up','left','down','right'][i]; 
  
  send({
    type: 'keyboard',
    data: {
      key: name,
      action: 'up'
    }
  });
});

$('.adb').on('click', function(evt) {
  i = ['kbb','kbh','kbs','kbp'].indexOf($(this).attr('id'));
  name = ['back','home','search','media_toggle'][i]; 
  
  send({
    type: 'keyboard',
    data: {
      key: name,
      action: 'adb'
    }
  });
});

$('#search').on('click', function() {
  send({
    type: 'keyboard',
    data: {
      key: 'search',
      action: 'adb'
    }
  });
  
  $('#keyboard').removeClass("hide");	
});

$(".btn").on("touchend", function(evt) {
  $(evt.target).removeClass('depressed');
});

$(".key").on("touchend", function(evt) {
  $(evt.target).removeClass('depressed');
});

$(".key:not('.btn')").on('touchstart', function(evt) {
  val=evt.target.innerText;
  if (val != '') {
    console.log(val);
    y = $(evt.target).offset().top;
    x = $(evt.target).offset().left;
   
    $('#key').removeClass('hide');
   $('#key').css('top', (y-80)+"px");
   $('#key').css('left', (x)+"px");
      $('#key').text(val);
    send({
      type: 'keyboard',
      data: {
        key: val,
        action: 'down' 
      }
    });
  }
});

$(".key:not('.btn')").on('touchend', function(evt) {
  val=evt.target.innerText;
  if (val != '') {
    console.log(val);
    window.setTimeout(function() {
      $('#key').addClass('hide');
    }, 222);
    
    send({
      type: 'keyboard',
      data: {
        key: val,
        action: 'up' 
      }
    });
  }
});


$("#center").on('click', function() {
  send(
    {type: 'center'}
  );
});

ea = document.getElementsByClassName('joystick');
for (var i=0;i < ea.length;i++) {
    e = ea.item(i);
    var options = {
        zone: e,
        mode: 'dynamic',
        position: {
          left: '50%',
          top: '50%'
        },
        color: "#adeade"
    };
    
    joysticks.push(mgr=nipplejs.create(options));
    
    mgr.on('start', function(evt, data) {
      data.move = false;
      navigator.vibrate(22);
    });
  
    mgr.on('move', function(evt,data) {
      i = joysticks.indexOf(this);
      
      if (data.instance.move == false ) {
        navigator.vibrate(55,5,55);
        data.instance.move = 1;
      } else {
        if (data.distance < 6) {
          return;
        } 
        
        data.instance.move = true;
        
        // send updates
        if (data.distance < 2) {
          navigator.vibrate(55,2, 5);
        }
        
        console.log(data.angle.degree);
        send({
          type: "motion",
          axis: i,
          data: {
            force: data.force,
            x: data.position.x,
            y: data.position.y,
            distance: data.distance,
            degree: data.angle.degree,
            radian: data.angle.radian
          }  
        });
      }
    }.bind(mgr));
    
    mgr.on("dir", function(evt, data) {
		navigator.vibrate(55,2, 5);
    console.log(data);
	  send({
		type: "direction",
		data: {
		  axis:	joysticks.indexOf(this),
		  direction: data.direction.angle,
		  distance: data.distance
		}  
	  });
	}.bind(mgr));
    
    mgr.on('end', function(evt, data) {
      if (data.move === 1) {
        // send tap
        send({
		      type: "tap",
		      data: {
			      axis: joysticks.indexOf(this)
		      }
		    });
        return;
      }
      
      data.move = false;
      
      send({
        type: 'end', 
        data: {
		      axis: joysticks.indexOf(this)
		    }
      });
    }.bind(mgr));
}
});//]]> 

// Let us open a web socket
 var ws = new WebSocket("ws://192.168.1.12:4567");

 ws.onopen = function()
 {
    // Web Socket is connected, send data using send()
    ws.send("Message to send");
 };

 ws.onmessage = function (evt) { 
    // $("#coords").text(evt.data);
    obj = eval('('+evt.data+')');
    
    if (obj.type == "shell") {
		  if (obj.data.action == "output") {
			  o = $("#output");
			  o.text(o.text() + obj.data.body);
		  }
    } 
    
    if (obj.type == "coords") {
      $("#coords").text(obj.data.x+" "+obj.data.y);
    }
 };

 ws.onclose = function()
 { 
    // websocket ins closed.
    alert("Connection is closed..."); 
 };
 
 function send(e) {
   ws.send(JSON.stringify(e));
 }
 
</script>

  
</head>

<body>
  <div class=column id=outer>
  <div class="row flex-none">
    <div class="btn cell app" id=hbo><img src="icons/app/HBO.png" ></img></div>
    <div class="btn cell app" id=amazon><img src="icons/app/amazon.png" ></img></div>
    <div class="btn cell app" id=youtube><img src="icons/Black/YouTube.png" ></img></div>
    <div class="btn cell app" id=tv><img src="icons/Black/TV.png" ></img></div>
    <div class="btn cell app" id=chrome><img src="icons/Black/Chrome.png" ></img></div>
    <div class="btn cell app" id=music><img src="icons/Black/Music.png" ></img></div>    
    <div class="btn cell app" id=app_menu><img src="icons/Black/List.png" ></img></div>   
    <div class="btn cell app" id=settings><img src="icons/White/Gear.png" ></img></div>       
  </div>

  <div class='row' id=coords>
  </div>

  <div class="row flex-none">
    <div class="space"></div>
    <div class="joy-ph cell" id=tl>
      <div class="space"></div>
      <div class="joystick"><img src="icons/White/Play.png" ></img></div>
      <div class="space"></div>
    </div>    
    <div class="space flex-more"></div>
    <div class='space'></div>
    <div class="btn cell flex-none btn-small" id=sync><img src="icons/White/Sync.png" ></img></div>
    <div class="cell flex-more input"></div>
    <div class="btn cell flex-none btn-small" id=search><img src="icons/White/Search.png" ></img></div>
    <div class='space flex-more'></div>
    <div class="joy-ph cell" id=tr>
      <div class="space"></div>
      <div class="joystick"><img src="icons/White/BootCamp.png" ></img></div>
      <div class="space"></div>    
    </div>    
    <div class=space></div>
  </div>

  <div class='row flex-more'>
    <div class="btn cell btn-small" id=back><img src="icons/White/Arrow Left.png" ></img></div> 
    
    <div class="joy-ph cell" id=ll>
      <div class="space"></div>
      <div class="joystick"><img src="icons/White/Add.png" ></img></div>
      <div class="space"></div>
    </div>
    
    <div class=flex-more></div>
    
    <div class="joy-ph cell" id=lr>
      <div class="space"></div>
      <div class="joystick"><img src="icons/White/Mouse.png" ></img></div>
      <div class="space"></div>    
    </div>
    
    <div class="btn cell btn-small" id=home><img src="icons/White/Home.png" ></img></div>
  </div>
  
  <div class=column id=keyboard>
    <div class='row flex-end'>
      <div class=key>`</div>
      <div class=key>1</div>
      <div class=key>2</div>
      <div class=key>3</div>
      <div class=key>4</div>
      <div class=key>5</div>
      <div class=key>6</div>
      <div class=key>7</div>
      <div class=key>8</div>
      <div class=key>9</div>
      <div class=key>0</div>
      <div class=key>-</div>
      <div class=key>=</div>
      <div class='key flex-more mod'>BkSp</div>
      <div class='space'></div>
      <div class="joy-ph cell" id=kbm>
        <div class="space"></div>
        <div class="joystick"><img src="icons/White/Mouse.png" ></img></div>
        <div class="space"></div>    
      </div>
    </div>
    
    <div class='row flex-end'>
      <div class=key>q</div>
      <div class=key>w</div>
      <div class=key>e</div>
      <div class=key>r</div>
      <div class=key>t</div>
      <div class=key>y</div>
      <div class=key>u</div>
      <div class=key>i</div>
      <div class=key>o</div>
      <div class=key>p</div>
      <div class=key>[</div>
      <div class=key>]</div>
      <div class=key>\</div>
      <div class="btn key cell btn-small ui" id=kbr><img src="icons/White/Sync.png" ></img></div>
      <div class='space'></div>
    </div>
    
    <div class=row>
      <div class=key>a</div>
      <div class=key>s</div>
      <div class=key>d</div>
      <div class=key>e</div>
      <div class=key>f</div>
      <div class=key>g</div>
      <div class=key>h</div>
      <div class=key>j</div>
      <div class=key>k</div>
      <div class=key>l</div>
      <div class=key>;</div>
      <div class=key>'</div>
    </div>        
    
    <div class=row>
      <div class=key>z</div>
      <div class=key>x</div>
      <div class=key>c</div>
      <div class=key>v</div>
      <div class=key>b</div>
      <div class=key>n</div>
      <div class=key>m</div>
      <div class=key>,</div>
      <div class=key>.</div>
      <div class=key>/</div>
      <div class=key><div class="btn key cell btn-small dpad" id=kbu><img src="icons/White/Arrow Up.png" ></img></div></div>
      <div class='key mod'>Enter</div>
    </div>    
    
    <div class=row>
      <div class='key mod'>Shift</div>
      <div class='key mod'>Tab</div>
      <div class="btn key cell btn-small adb" id=kbb><img src="icons/White/Arrow Circle Left.png" ></img></div>
      <div class='key flex3'>Space</div>
      <div class="btn key cell btn-small adb" id=kbh><img src="icons/White/Home.png" ></img></div>
      <div class="btn key cell btn-small adb" id=kbs><img src="icons/White/Search.png" ></img></div>
      <div class="btn key cell btn-small adb" id=kbp><img src="icons/White/Play.png" ></img></div>
      <div class='key mod'>Ctrl</div>

      <div class=key><div class="btn key cell btn-small dpad" id=kbl><img src="icons/White/Arrow Left.png" ></img></div></div>
      <div class=key><div class="btn key cell btn-small dpad" id=kbd><img src="icons/White/Arrow Down.png" ></img></div></div>
      <div class=key><div class="btn key cell btn-small dpad" id=kbr><img src="icons/White/Arrow Right.png" ></img></div></div>
      
           <div class='space'></div>
      <div class="joy-ph cell" id=kbw>
        <div class="space"></div>
        <div class="joystick"><img src="icons/White/BootCamp.png" ></img></div>
        <div class="space"></div>    
      </div>
    </div>    
  </div>
  
  <div id=key></div>
  
  <div id=shell class="hide">
    <div id=output></div>
    <input type='text' id=input></input>
  </div>
  <div id=center class=btn>
    x
  </div>
</div>
  
</body>

</html>
